import MdxLayout from "../../../components/mdx-layout";
import { CodeBlock } from "../../../components/code-block";
import { BEYOND_VIBE_CODING } from "../../../lib/state/blog";

export const metadata = {
  title: "How I Use Claude Code Hooks in My Workflow",
  date: BEYOND_VIBE_CODING.date,
  description:
    "A few practical hooks I've been using with Claude Code for notifications, auto-formatting, and keeping my workflow smooth.",
  keywords:
    "Claude Code, hooks, developer productivity, osascript, notifications, automation, AI development, workflow optimization, CLAUDE.MD, GitHub Actions",
  category: "AI Development",
  readTime: "5 min read",
  author: "Johannes Mändle",
};

# {metadata.title}

I've been using Claude Code hooks to automate parts of my workflow, and they've made a real difference. Hooks are shell commands that run automatically at specific points—like after editing a file or when a task completes. Here are a few I've found useful.

## Hook Events I Use

You configure hooks in `.claude/settings.json`. The three I use most are:

- **PostEdit** - Runs after Claude edits a file (I use this for auto-formatting)
- **Stop** - Runs when a task finishes (perfect for notifications)
- **PostWrite** - Runs after Claude creates new files (useful for security checks)

## Hooks I Actually Use

### Desktop Notifications (macOS)

I use this to get notified when long-running tasks finish. It uses `osascript` to show a native macOS notification:

<CodeBlock language="json" code={`{
  "hooks": {
    "Stop": {
      "command": "osascript -e 'display notification \\"Claude Code task completed\\" with title \\"AI Development\\" sound name \\"Glass\\"'",
      "description": "Notify when task completes"
    }
  }
}`}/>

> **What is osascript?**
> `osascript` is macOS's built-in command-line tool for running AppleScript. It lets you control macOS apps, show notifications, and automate system tasks from the terminal.
> **Windows/Linux alternatives:** `notify-send` (Linux), `msg` or PowerShell's `New-BurntToastNotification` (Windows)

This lets me start a refactoring, switch to something else, and get pinged when it's done.

### Auto-Format on Every Edit

I run Prettier and ESLint on every file Claude touches:

<CodeBlock language="json" code={`{
  "hooks": {
    "PostEdit": {
      "command": "prettier --write {{file_path}} && eslint --fix {{file_path}}",
      "description": "Auto-format and lint"
    }
  }
}`}/>

This keeps formatting consistent without thinking about it.

### Security Scanning on New Files

This scans new files for potential secrets:

<CodeBlock language="json" code={`{
  "hooks": {
    "PostWrite": {
      "command": "git secrets --scan {{file_path}} || echo 'Warning: Potential secret detected!'",
      "description": "Scan for leaked secrets"
    }
  }
}`}/>

Helps catch API keys or tokens before they get committed.



## Keeping CLAUDE.MD Current

I often forget to update my `CLAUDE.MD` file after making changes. Here are two ways I've tried to automate reminders:

### Hook-Based Reminder

This hook checks if core files changed and reminds me to update docs:

<CodeBlock language="json" code={`{
  "hooks": {
    "Stop": {
      "command": "echo '\\n📝 Reminder: Update CLAUDE.MD if project structure changed\\nRun: claude update-docs' && git diff --stat HEAD~5 | grep -E 'src/|components/|lib/' && echo '\\n⚠️  Core files changed - CLAUDE.MD update recommended!'",
      "description": "Check if CLAUDE.MD needs updating"
    }
  }
}`}/>

I also set up an alias to make updating easier:
<CodeBlock language="bash" code={`alias update-docs="claude 'Analyze recent changes and update CLAUDE.MD with new architecture details'"`}/>

### GitHub Action for Teams

For projects with multiple people, I've used a weekly GitHub Action that creates an issue when there are significant changes:

<CodeBlock language="yaml" code={`name: Update CLAUDE.MD
on:
  schedule:
    - cron: '0 9 * * 1'  # Every Monday at 9 AM
  workflow_dispatch:  # Allow manual triggers

jobs:
  update-docs:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
        with:
          fetch-depth: 0  # Full history for analysis

      - name: Analyze changes and update CLAUDE.MD
        run: |
          # Get changes from last week
          git log --since="7 days ago" --name-status --pretty=format:"" | \
          grep -E "^[AM].*\\.(ts|tsx|js|jsx)$" > recent_changes.txt

          # Count significant changes
          CHANGE_COUNT=$(wc -l < recent_changes.txt)

          if [ $CHANGE_COUNT -gt 10 ]; then
            echo "📊 $CHANGE_COUNT files changed this week"
            echo "Consider updating CLAUDE.MD to reflect:"
            cat recent_changes.txt
            # Optionally: Create an issue or PR
          fi

      - name: Create update reminder issue
        if: env.CHANGE_COUNT > 10
        uses: actions/github-script@v7
        with:
          script: |
            github.rest.issues.create({
              owner: context.repo.owner,
              repo: context.repo.repo,
              title: '📝 CLAUDE.MD Update Recommended',
              body: 'Significant changes detected this week. Review and update project documentation.'
            });
`}/>

This runs every Monday and creates an issue if there were more than 10 file changes that week.

## A Few Things I've Learned

**Chaining commands:** You can run multiple commands in one hook with `&&`:
<CodeBlock language="bash" code={`"command": "prettier --write {{file_path}} && eslint --fix {{file_path}} && git add {{file_path}}"`}/>

**Debugging:** If a hook fails, test the command manually in your terminal first. Hook errors show up in Claude Code's output.

**Cross-platform:** Use conditional commands if you work across different OSes:
<CodeBlock language="json" code={`{
  "hooks": {
    "Stop": {
      "command": "if [[ $OSTYPE == 'darwin'* ]]; then osascript -e 'display notification \\"Done\\"'; else notify-send 'Done'; fi",
      "description": "Cross-platform notifications"
    }
  }
}`}/>

**Variables:** Hooks support `{{file_path}}`, `{{tool_name}}`, and `{{project_root}}`.

---

## Resources

**Docs:**
- [Claude Code Hooks Guide](https://docs.claude.com/en/docs/claude-code/hooks-guide)
- [Claude Code Settings](https://docs.claude.com/en/docs/claude-code/settings)

**Tools:**
- [git-secrets](https://github.com/awslabs/git-secrets) - Scan for leaked credentials
- [osascript Examples](https://ss64.com/osx/osascript.html) - macOS automation

**My advice:** Start with one hook (notifications work well), use it for a week, then add more as you find friction points in your workflow.

export default function Page({ children }) {
  return (
    <MdxLayout metadata={metadata} slug={BEYOND_VIBE_CODING.slug}>
      {children}
    </MdxLayout>
  );
}
